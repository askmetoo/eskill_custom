{
 "absolute_value": 0,
 "align_labels_right": 0,
 "creation": "2021-10-07 15:11:52.429869",
 "css": "@font-face {\n\tfont-family: DaxlinePro;\n\tfont-style: normal;\n\tfont-weight: 300;\n\tsrc: url(/fonts/DaxlinePro.ttf);\n}\n\n@font-face {\n\tfont-family: Neuropol;\n\tfont-style: normal;\n\tfont-weight: 300;\n\tsrc: url(/fonts/NeuropolXRG.ttf);\n}\n\n@font-face {\n    font-family: 'Atlanta';\n    src: url(/fonts/Atlanta-Book.woff2) format('woff2'),\n        url(/fonts/Atlanta-Book.woff) format('woff'),\n        url(/fonts/Atlanta-Book.ttf) format('truetype');\n    font-weight: normal;\n    font-style: normal;\n    font-display: swap;\n}\n\n.print-format { \n    padding: 0mm !important;\n    font-family: 'Atlanta';\n}\n\nbody, p, span, div, element {\n    color: #474c51;\n    letter-spacing: normal !important;\n}\n\n#header-image {\n    background-image: url(/files/Eskill_Header.jpg);\n    display: table;\n    width: 100%;\n    background-size: 211mm;\n    background-repeat: no-repeat;\n    height: 38mm;\n    background-position: left top;\n    padding-top: 7mm !important;\n}\n\n.layout-table, .layout-row, .layout-div {\n    margin: 0 !important;\n    padding: 0 !important;\n    width: 100% !important;\n}\n\n.layout-cell {\n    margin: 0 !important;\n    padding: 0 !important;\n    height: 100%;\n    vertical-align: middle;\n}\n\n\n\n#print-heading {\n    font-family: DaxlinePro;\n    font-size: 18pt;\n    font-weight: bold;\n    line-height: 1;\n    padding: 0mm !important;\n    margin-top: 4mm !important;\n    margin-right: 6mm !important;\n    margin-bottom: 3mm !important;\n    text-align: right;\n}\n\n#company-info-cell {\n    width: 40%;\n}\n\n#company-info {\n    font-size: 7pt;\n    margin-left: 6mm !important;\n}\n\n#project-name-cell {\n    width: 35%;\n    vertical-align: bottom;\n}\n\n#tax-info-cell {\n    width: 25%;\n}\n\n#tax-info {\n    font-size: 7pt;\n    text-align: right;\n    margin-right: 5mm;\n    margin-top: 5mm;\n}\n\n#tax-info p {\n    margin: 0;\n    padding: 0;\n}\n\n#top-info {\n    margin-left: 7mm;\n    margin-right: 7mm;\n}\n\n#middle-section {\n    margin-left: 7mm !important;\n    margin-right: 7mm !important;\n}\n\n#fault-report {\n    min-height: 39mm;\n    height: 39mm;\n}\n\n#office-use, #tech-cert {\n    min-height: 19mm;\n    height: 19mm;\n}\n\n#device-info {\n    min-height: 28mm;\n    height: 28mm;\n}\n\n#one-quarter {\n    width: 25%;\n}\n\n#one-third {\n    width: 33%;\n}\n\n#one-half {\n    width: 50%;\n}\n\n.fill-in-field {\n    margin-top: 8mm;\n    border-top: 1px dotted #474c51;\n    text-align: center;\n    width: 100%;\n    font-size: 7pt;\n    font-weight: bold;\n    line-height: 1.2;\n    padding-bottom: 0;\n    margin-bottom: 0;\n}\n\n#product-image {\n    text-align: center;\n    width: 25%;\n    float: left;\n    display: inline;\n    padding-top: 2mm;\n}\n\n#device-details {\n    text-align: left;\n    width: 75%;\n    float: left;\n    display: inline;\n    padding: 2mm;\n}\n\n#total-section {\n    margin-left: 7mm;\n    margin-right: 7mm;\n    margin-bottom: 1mm;\n    height: 43mm;\n    max-height: 43mm;\n    min-height: 43mm;\n    overflow: hidden;\n}\n\n.black-box {\n    border: 1px solid #474c51;\n    border-radius: 3px;\n    padding: 0.5mm;\n    margin-left: 1mm;\n    margin-bottom: 1mm;\n    width: auto;\n    height: auto;\n    overflow: hidden;\n    min-height: 12mm;\n}\n\n.yellow-box {\n    border: 1px solid #ffbd20;\n    border-radius: 3px;\n    background-color: #ffbd20;\n    padding: 0.5mm;\n    margin-left: 1mm;\n    margin-bottom: 1mm;\n    width: auto;\n    height: auto;\n    overflow: hidden;\n    min-height: 12mm;\n}\n\n.yellow-bar {\n    background-color: #ffbd20;\n    border-radius: 2px;\n    width: 100%;\n    text-align: center;\n    line-height: 1.5;\n    font-size: 7pt;\n    font-weight: bold;\n    color: #252525;\n}\n\n.filled-grey-box {\n    border: 1px solid #cfcfcf;\n    border-radius: 3px;\n    background-color: #cfcfcf;\n    padding: 1mm;\n    margin-left: 1mm;\n    margin-bottom: 1mm;\n    width: auto;\n    height: 12mm;\n    overflow: hidden;\n    min-height: 12mm;\n    max-height: 12mm;\n    color: #000000 !important;\n}\n\n\n.black-bar {\n    border-bottom: 1px solid #252525;\n    width: 100%;\n    text-align: center;\n    line-height: 1.5;\n    font-size: 7pt;\n    font-weight: bold;\n    color: #252525;\n}\n\n.box-content-left {\n    padding: 1mm;\n    font-size: 9pt;\n    text-align: left;\n    overflow: hidden;\n}\n\n.box-content-justified {\n    padding: 0;\n    font-size: 8pt;\n    text-align: justify;\n    overflow: hidden;\n}\n\n.box-content-justified ol li {\n    margin-right: 10mm;\n    margin-top: 0;\n}\n\n.box-content-center {\n    padding: 1mm;\n    font-size: 9pt;\n    text-align: center;\n    overflow: hidden;\n}\n\n.box-content-right {\n    padding: 1mm;\n    font-size: 9pt;\n    text-align: right;\n    overflow: hidden;\n}\n\n#customer-info {\n    width: 65%;\n    padding: 0 !important;\n    height: auto;\n}\n\n#customer {\n    height: 36mm;\n    max-height: 36mm;\n    min-height: 36mm;\n}\n\n#document-info {\n    width: 35%;\n    padding: 0 !important;\n}\n\n#document-number-cell {\n    margin: 0 !important;\n    padding: 0!important;\n    height: 12mm;\n    vertical-align: middle;\n}\n\n#page-cell, #date-cell, #other-number-cell, #exchange-rate-cell, #customer-vat-cell, #customer-ref-cell, #issue-type-cell {\n    margin: 0 !important;\n    padding: 0!important;\n    height: 12mm;\n    vertical-align: middle;\n}\n\n#fault-report-cell, #office-use-cell {\n    width: 50%;\n    margin: 0 !important;\n    padding: 0!important;\n    vertical-align: middle;    \n}\n\ntr.nospace-row td.label-cell {\n    width: 20%;\n    margin: 0 !important;\n    padding: 0 !important;\n}\n\ntr.nospace-row td.data-cell {\n    width: 30%;\n    margin: 0 !important;\n    padding: 0 !important;\n}\n\ntr.nospace-row {\n    margin: 0 !important;\n    padding: 0 !important;\n}\n\n#product-name {\n    font-size: 14px;\n    font-weight: bold;\n    margin: 0;\n}\n\n#product-serial {\n    font-size: 12px;\n    font-weight: bold;\n    margin: 0 0 2mm 0;\n}\n\n#device-details-table {\n    table-layout: fixed;\n    width: 100%;\n}\n\n#date-cell {\n    width: 50%;\n}\n\n#document-number {\n    font-weight: bold;\n    font-size: 12pt;\n}\n\n#customer-currency-cell {\n    width: 10%;\n    margin: 0 !important;\n    padding: 0!important;\n    height: 12mm;\n    vertical-align: middle;\n}\n\n#salesperson-cell {\n    width: 35%;\n    margin: 0 !important;\n    padding: 0!important;\n    height: 12mm;\n    vertical-align: middle;\n}\n\n#other-number, #customer-currency, #exchange-rate, #customer-vat, #customer-ref, #salesperson {\n    font-weight: normal;\n    font-size: 9pt;\n}\n\n.project-name {\n    padding: 0mm;\n    font-size: 8pt;\n    text-align: center;\n    overflow: hidden;\n    font-weight: bold;\n    vertical-align: middle !important;\n    height: 40px !important;\n    max-height: 40px !important;\n    border-radius: 4px;\n}\n\n#project-text {\n    display: table;\n    float: left;\n    text-align: left;\n}\n\n#project-text p {\n        display: table-cell;\n        vertical-align: middle !important;\n        height: 40px;\n        min-height: 40px;\n        max-height: 40px;\n}\n\n#project-icon {\n    display: inline-block;\n    width: 40px !important;\n    height: 40px !important;\n    max-height: 40px !important;\n    object-fit: none;\n    float: left;\n}\n\n.yellow-head-center {\n    background-color: #ffbd20;\n    width: 100%;\n    text-align: center;\n    line-height: 1.5;\n    font-size: 7pt;\n    font-weight: bold;\n    color: #2a2a2a;\n    padding: 0 5px 0 5px;\n}\n\n.yellow-head-left {\n    background-color: #ffbd20;\n    width: 100%;\n    text-align: left;\n    line-height: 1.5;\n    font-size: 7pt;\n    font-weight: bold;\n    color: #2a2a2a;\n    padding: 0 5px 0 5px;\n}\n\n.yellow-head-right {\n    background-color: #ffbd20;\n    width: 100%;\n    text-align: right;\n    line-height: 1.5;\n    font-size: 7pt;\n    font-weight: bold;\n    color: #2a2a2a;\n    padding: 0 5px 0 5px;\n}\n\n#items {\n    table-layout: fixed;\n}\n\n#item-line { width: 5% !important; padding: 0 !important; border-right: 1px solid #ffbd20; }\n#item-item { width: 16% !important; padding: 0 !important; border-right: 1px solid #ffbd20; }\n#item-description { width: 45% !important; padding: 0 !important; border-right: 1px solid #ffbd20; }\n#item-qty { width: 5% !important; padding: 0 !important; border-right: 1px solid #ffbd20; }\n#item-price { width: 11% !important; padding: 0 !important; border-right: 1px solid #ffbd20; }\n#item-uom { width: 7% !important; padding: 0 !important; border-right: 1px solid #ffbd20; }\n#item-total { width: 11% !important; padding: 0 !important; }\n\n#item-line, #item-item, #item-qty, #item-uom, #item-price, #item-total, #item-description {\n    height: auto;\n}\n\n#item-line div, #item-item div, #item-qty div, #item-uom div, #item-price div, #item-total div { \n    overflow: hidden;\n    max-height: 12pt;\n    height: 12pt;\n}\n\n#item-description div.yellow-head-left, #item-description div.yellow-head-center, #item-description div.yellow-head-right {\n    max-height: 12pt;\n    height: 12pt;\n}\n\n.cell-content-center {\n    width: 100%;\n    text-align: center;\n    line-height: 1.5;\n    font-size: 8pt !important;\n    font-weight: normal;\n    padding: 0 5px 0 5px;\n}\n\n.cell-content-left {\n    width: 100%;\n    text-align: left;\n    line-height: 1.5;\n    font-size: 8pt !important;\n    font-weight: normal;\n    padding: 0 5px 0 5px;\n}\n\n.cell-content-right {\n    width: 100%;\n    text-align: right;\n    line-height: 1.5;\n    font-size: 8pt !important;\n    font-weight: normal;\n    padding: 0 5px 0 5px;\n}\n\n#bank-info-cell {\n    width: 65%;\n    padding: 0 !important;\n}\n\n#bank-info {\n    height:18mm;\n    min-height: 18mm;\n    max-height: 18mm;\n    overflow: hidden;\n}\n\n.bank-account {\n    display: inline;\n    float: left;\n    font-size: 7pt;\n    line-height: 1.2;\n    margin: 1%;\n    width: 12%;\n    color: #252525;\n}\n\n#totals-info-cell {\n    width: 35%;\n    padding: 0 !important;\n}\n\n#totals-info {\n    height: 43mm;\n    max-height: 43mm;\n    min-height: 43mm;\n}\n\n#fiscal-signature {\n    height: 10mm;\n    min-height: 10mm;\n    max-height: 10mm;\n    /* border: 1px dashed #494949; */\n    border-radius: 3px;\n    margin-left: 8mm;\n    margin-right: 7mm;\n    margin-bottom: 10mm;\n}\n\n#footer {\n    display: table;\n    width: 100%;\n    background-image: url(/files/Eskill_Footer.jpg);\n    background-size: 211mm;\n    background-repeat: no-repeat;\n    height: 24mm;\n    background-position: left bottom;\n}\n\n#customer-signature {\n    display: table-cell;\n    vertical-align: bottom;\n    margin: 0;\n    font-size: 8pt;\n}\n\n#customer-signature p {\n    border-top: 1px dotted #000;\n    font-size: 8pt;\n    width: 120mm;\n    margin-left: 20mm;\n    margin-bottom: 6mm;\n    text-align: center;\n    padding-top: 1mm;\n}\n\n.banner120pt {\n    display: table;\n    min-height: 120pt;\n    width: 100%;\n    text-align: center;\n    opacity: 0.2;\n}\n\n.banner240pt {\n    display: table;\n    min-height: 240pt;\n    width: 100%;\n    text-align: center;\n    opacity: 0.2;\n}\n\n#banner {\n    display: table-cell;\n    vertical-align: middle !important;\n}\n\n#banner img {\n    vertical-align: middle !important;\n}",
 "custom_format": 1,
 "default_print_language": "en",
 "disabled": 0,
 "doc_type": "Service Order",
 "docstatus": 0,
 "doctype": "Print Format",
 "font": "Default",
 "html": "{% macro projectsvg(project_colour) %}\r\n\r\n    <svg id=\"Layer_1\" style=\"enable-background:new 0 0 512 512; width:35px; height: 35px;\" version=\"1.1\" viewBox=\"0 0 512 512\" xml:space=\"preserve\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\"><style type=\"text/css\">\r\n    \t.st0{fill:{{ project_colour }};}\r\n    \t.st1{fill:#232323;}\r\n    </style><g id=\"XMLID_174_\"><path class=\"st0\" d=\"M41,315.8c-5.8,0-11.4-1.6-16.4-4.6L6,300v172.5h67.5V297.1l-11,10.2   C56.7,312.8,49,315.8,41,315.8z\" id=\"XMLID_3390_\"/><polygon class=\"st0\" id=\"XMLID_183_\" points=\"143.2,232.4 143.2,472.6 210.8,472.6 210.8,225.5 176.1,201.8  \"/><path class=\"st0\" d=\"M290.2,273.1c-6.4,0-12.6-1.9-17.9-5.5l-13.3-9.1v214h67.5V251.8L311,265.4   C305.2,270.4,297.8,273.1,290.2,273.1z\" id=\"XMLID_182_\"/><polygon class=\"st0\" id=\"XMLID_175_\" points=\"378.5,472.6 446,472.6 446,148 378.5,206.7  \"/><path class=\"st1\" d=\"M401.1,69.3L429,96.4L288.8,217.5l-105.1-71.8c-7.3-5-17.2-4.3-23.7,1.8l-121.6,113L6.1,240.9   v44.4l25.1,15.1c7.3,4.4,16.5,3.4,22.8-2.4l120.9-112.4l104.6,71.5c7.1,4.9,16.7,4.3,23.2-1.3l153.7-132.9l23,22.3L506,39.4   L401.1,69.3z\" id=\"XMLID_498_\"/></g></svg>\r\n\r\n{% endmacro %}\r\n\r\n{% macro pageheader() %}\r\n\r\n<!DOCTYPE html>\r\n\r\n<div id=\"header-image\" class=\"layout-div\">\r\n    \r\n    <div id=\"print-heading\">{{ \"SERVICE ORDER\" }}</div>\r\n\r\n    <!-- Company Information -->\r\n    <table class=\"layout-table\">\r\n        <tbody>\r\n        <tr class=\"layout-row\">\r\n            <td class=\"layout-cell\" id=\"company-info-cell\">\r\n                <div id=\"company-info\">\r\n                    <p>\r\n                        {% set our_address =  frappe.db.get_value(\"Address\", \"Eskill Trading Support-Office\", \"address_line1\") ~ ', ' ~ frappe.db.get_value(\"Address\", \"Eskill Trading-Office\", \"address_line2\") ~ ', ' ~ frappe.db.get_value(\"Address\", \"Eskill Trading-Office\", \"city\") %}\r\n                        {% if our_address and our_address != 'None' %}{{ our_address }}{% else %}118 Enterprise Road, Highlands, Harare{% endif %}\r\n                    </p>\r\n                    <p>\r\n                        {% set our_phone = frappe.db.get_value(\"Address\", \"Eskill Trading Support-Office\", \"phone\") %}\r\n                        Phone: {% if our_phone and our_phone != 'None' %}{{ our_phone }}{% else %}+263 8677002000, +263 772148705-8{% endif %}<br>\r\n                        {% set our_email = frappe.db.get_value(\"Address\", \"Eskill Trading Support-Office\", \"email_id\") %}\r\n                        Email: {% if our_email and our_email != 'None' %}{{ our_email }}{% else %}support@eskilltrading.com{% endif %}\r\n                    </p>\r\n                </div>\r\n            </td>\r\n            \r\n            \r\n            <td class=\"layout-cell\" id=\"project-name-cell\">\r\n                {% if doc.project %}\r\n                    {% set thisproject= frappe.get_doc(\"Project\", doc.project) %}\r\n                    {% set project_style = 'style=\\\"font-weight: bold; color: ' ~ thisproject.project_colour ~ '; border: 2px solid ' ~ thisproject.project_colour ~ ';\\\"' | safe %}\r\n                    <table class=\"layout-table\">\r\n                        <tbody><tr class=\"layout-row\">\r\n                            <td class=\"layout-cell\" style=\"vertical-align: middle;\">\r\n                                <div class=\"project-name\" {{ project_style }}>\r\n                                  <span id=\"project-icon\">\r\n                                    {{ projectsvg(thisproject.project_colour) }}\r\n                                  </span>\r\n                                  <span id=\"project-text\">  \r\n                                    {% set project_title_style = 'style=\\\"color: ' ~ thisproject.project_colour ~ '; font-weight: bold;\\\"' | safe %}\r\n                                    <p {{ project_title_style }}>PROJECT<br>{{ doc.project | truncate(27, True) }}</p>\r\n                                    \r\n                                  </span>\r\n                                </div>\r\n                            </td>\r\n                        </tr></tbody>\r\n                    </table>\r\n                {% endif %}\r\n            </td>\r\n            \r\n            <!-- Tax Information -->\r\n            <td class=\"layout-cell\" id=\"tax-info-cell\">\r\n                <div id=\"tax-info\">\r\n                    <p>VAT Number: {{ frappe.db.get_value(\"Company\", \"Eskill Trading (Pvt) Ltd\", \"tax_id\") }}</p>\r\n                    <p>BP Number: {{ frappe.db.get_value(\"Company\", \"Eskill Trading (Pvt) Ltd\", \"bp_number\") }}</p>\r\n                </div>\r\n            </td>\r\n        </tr>\r\n        </tbody>\r\n    </table>\r\n</div>\r\n<div id=\"top-info\">\r\n    <table class=\"layout-table\">\r\n        <tbody>\r\n        <tr class=\"layout-row\">\r\n            \r\n            <!-- Customer Name and Address -->\r\n            <td class=\"layout-cell\" id=\"customer-info\">\r\n                <div class=\"black-box\">\r\n                    <div class=\"yellow-bar\">\r\n                        Service Provided To\r\n                    </div>\r\n                    <div class=\"box-content-left\" id=\"customer\">\r\n                        {% if doc.customer %}\r\n                            {% set thiscustomer = frappe.get_doc(\"Customer\", doc.customer) %}\r\n                            <strong>{{ doc.customer }}</strong> - {{ thiscustomer.customer_name }}<br>\r\n                        {% endif %}\r\n                        {% if thiscustomer %}\r\n                            {% if thiscustomer.primary_address %}\r\n                                {{ thiscustomer.primary_address }}\r\n                            {% else %}\r\n                                {% set address_links = frappe.get_all('Dynamic Link', filters=[['link_doctype', '=', 'Customer'],['link_name', '=', doc.customer],['parenttype', '=', 'Address']], fields=['parent']) %}\r\n                                {% set cust_address = namespace(line1='', line2='', city='', country='', email='', phone='') %}\r\n                                {% for add_link in address_links %}\r\n                                    {% set thisaddress = frappe.get_doc(\"Address\", add_link.parent) %}\r\n                                    {% set cust_address.line1 = thisaddress.address_line1 %}\r\n                                    {% set cust_address.line2 = thisaddress.address_line2 %}\r\n                                    {% set cust_address.city = thisaddress.city %}\r\n                                    {% set cust_address.country = thisaddress.country %}\r\n                                    {% set cust_address.email = thisaddress.email_id %}\r\n                                    {% set cust_address.phone = thisaddress.phone %}\r\n                                {% endfor %}\r\n                                {% if cust_address.line1 %}{{ cust_address.line1 }}<br>{% endif %}\r\n                                {% if cust_address.line2 %}{{ cust_address.line2 }}<br>{% endif %}\r\n                                {% if cust_address.city %}{{ cust_address.city }}<br>{% endif %}\r\n                                {% if cust_address.country %}{{ cust_address.country }}<br>{% endif %}\r\n                                {% if cust_address.phone %}Phone: {{ cust_address.phone }}<br>{% endif %}\r\n                                {% if cust_address.email %}Email: {{ cust_address.email }}{% endif %}\r\n                            {% endif %}\r\n                        {% endif %}\r\n                    </div>\r\n                </div>\r\n            </td>\r\n        \r\n            <!-- Document Information -->\r\n            <td class=\"layout-cell\" id=\"document-info\">\r\n                <table class=\"layout-table\">\r\n                    <tbody>\r\n                        <tr class=\"layout-row\">\r\n                            <td class=\"layout-cell\" id=\"date-cell\">\r\n                                <div class=\"black-box\">\r\n                                    <div class=\"yellow-bar\">\r\n                                        Opened\r\n                                    </div>\r\n                                    <div class=\"box-content-center\" id=\"date\">\r\n                                        {% if doc.start_date %}\r\n                                            {{ frappe.utils.get_datetime(doc.start_date).strftime(\"%d-%m-%Y\") }}\r\n                                        {% endif %}\r\n                                    </div>\r\n                                </div>\r\n                            </td>\r\n                            <td class=\"layout-cell\" id=\"date-cell\">\r\n                                <div class=\"black-box\">\r\n                                    <div class=\"yellow-bar\">\r\n                                        Resolved\r\n                                    </div>\r\n                                    <div class=\"box-content-center\" id=\"date\">\r\n                                        {% if doc.closing_date %}\r\n                                            {{ frappe.utils.get_datetime(doc.closing_date).strftime(\"%d-%m-%Y\") }}\r\n                                        {% else %}\r\n                                            Still<br>Active\r\n                                        {% endif %}\r\n                                    </div>\r\n                                </div>\r\n                            </td>\r\n                        </tr>\r\n                    </tbody>\r\n                </table>\r\n                <table class=\"layout-table\">\r\n                    <tbody>\r\n                        <tr class=\"layout-row\">\r\n                            <td class=\"layout-cell\" id=\"document-number-cell\">\r\n                                <div class=\"black-box\">\r\n                                    <div class=\"yellow-bar\">\r\n                                        Order Number\r\n                                    </div>\r\n                                    <div class=\"box-content-center\" id=\"document-number\">\r\n                                        {% if doc.name %}{{ doc.name }}{% endif %}\r\n                                    </div>\r\n                                </div>\r\n                            </td>                            \r\n                        </tr>                        \r\n                        <tr class=\"layout-row\">\r\n                            <td class=\"layout-cell\" id=\"other-number-cell\">\r\n                                <div class=\"black-box\">\r\n\r\n                                        <div class=\"yellow-bar\">Technician</div>\r\n                                        <div class=\"box-content-center\" id=\"other-number\">\r\n                                            {% if doc.technician_name %}{{ doc.technician_name }}{% endif %}                                      \r\n                                        </div>\r\n                                    \r\n                                </div>\r\n                            </td>                            \r\n                        </tr>\r\n                    </tbody>\r\n                </table>\r\n            </td>\r\n        \r\n        </tr>\r\n        </tbody>\r\n    </table>\r\n    <table class=\"layout-table\">\r\n        <tbody>\r\n            <tr class=\"layout-row\">\r\n                <td class=\"layout-cell\" id=\"customer-vat-cell\">\r\n                    <div class=\"black-box\">\r\n                        <div class=\"yellow-bar\">Customer VAT</div>\r\n                        <div class=\"box-content-center\" id=\"customer-vat\">\r\n                            {% if doc.customer and doc.customer != 'None' %}\r\n                                {% set thiscustomer= frappe.get_doc(\"Customer\", doc.customer) %}\r\n                                {{ thiscustomer.tax_id }}\r\n                            {% endif %}\r\n                        </div>\r\n                    </div>                    \r\n                </td>\r\n                <td class=\"layout-cell\" id=\"customer-ref-cell\">\r\n                    <div class=\"black-box\">\r\n                        <div class=\"yellow-bar\">Customer Reference</div>\r\n                        <div class=\"box-content-center\" id=\"customer-ref\">\r\n                            {% if doc.customer_reference %}{{ doc.customer_reference }}{% endif %}\r\n                        </div>\r\n                    </div>                    \r\n                </td>\r\n                <td class=\"layout-cell\" id=\"issue-type-cell\">\r\n                    <div class=\"black-box\">\r\n                        <div class=\"yellow-bar\">Service Type</div>\r\n                        <div class=\"box-content-center\" id=\"customer-ref\">\r\n                            {% if doc.job_type %}{{ doc.job_type }}{% endif %}\r\n                        </div>\r\n                    </div>                    \r\n                </td>                \r\n                <td class=\"layout-cell\" id=\"salesperson-cell\">\r\n                    <div class=\"black-box\">\r\n                        <div class=\"yellow-bar\">Processed By</div>\r\n                        <div class=\"box-content-center\" id=\"salesperson\">\r\n                            {% set thisuser = frappe.get_doc(\"User\", frappe.user) %}\r\n                            {% if thisuser and thisuser.first_name and thisuser.first_name != 'None' %}\r\n                                {{ thisuser.first_name }}{% if thisuser.last_name and thisuser.last_name != 'None' %} {{ thisuser.last_name }}{% endif %}\r\n                            {% else %}\r\n                                {{ frappe.user }}\r\n                            {% endif %}\r\n                        </div>\r\n                    </div>                    \r\n                </td>\r\n                \r\n                \r\n            </tr>\r\n        </tbody>\r\n    </table>\r\n\r\n\r\n</div>\r\n\r\n\r\n{% endmacro %}\r\n\r\n{{ pageheader() }}\r\n\r\n\r\n<div id=\"middle-section\">\r\n    {% if not doc.multiple_devices %}\r\n        {% if doc.model and doc.model != 'None' %}\r\n            {% set thisproduct = frappe.get_doc(\"Item\", doc.model) %}\r\n            {% if doc.serial_number and doc.serial_number != 'None' %}\r\n                {% set thisserial = frappe.get_doc(\"Serial No\", doc.serial_number) %}\r\n            {% endif %}\r\n            <div id=\"device-info\" class=\"black-box\">\r\n                <div class=\"yellow-bar\">Device Information</div>\r\n                <div id=\"device-details\">\r\n                    <p id=\"product-name\">{{ thisproduct.item_name }}</p>\r\n                    <p id=\"product-serial\">{% if doc.serial_number %}<strong>{{ doc.serial_number }}</strong>{% else %}Non-Serialised{% endif %}</p>\r\n                    <table id=\"device-details-table\"><tbody style=\"font-size: 12;\">\r\n                        <tr class=\"nospace-row\">\r\n                            <td class=\"label-cell\">\r\n                                {% if doc.model %}Item Code:{% else %}Unlisted Item Code{% endif %}\r\n                            </td>\r\n                            <td class=\"data-cell\">\r\n                                {% if doc.model %}{{ doc.model }}{% endif %}\r\n                            </td>\r\n                            <td class=\"label-cell\">\r\n                                {% if thisserial.serial_no %}Warranty Expiry:{% endif %}\r\n                            </td>\r\n                            <td class=\"data-cell\">\r\n                                {% if doc.serial_number and thisserial.warranty_expiry_date %}{{ frappe.utils.formatdate(thisserial.warranty_expiry_date, \"dd-MM-yyyy\") }}{% endif %}\r\n                            </td>\r\n                        </tr>\r\n                        {% if thisserial and thisserial.status == \"Delivered\" %}\r\n                            {% set date_difference = 0 %}\r\n                            {% if doc.serial_number and thisserial.warranty_expiry_date %}\r\n                                {% set date_difference = frappe.utils.date_diff(thisserial.warranty_expiry_date,frappe.utils.today()) %}\r\n                            {% endif %}\r\n                            {% if thisserial.warranty_expiry_date and date_difference < 0 %}\r\n                                {% set wstatus = \"INVALID\" %}\r\n                            {% elif thisserial.warranty_expiry_date and date_difference > 0 %}\r\n                                {% set wstatus = \"VALID\" %}\r\n                            {% elif thisserial.warranty_expiry_date and date_difference == 0 %}\r\n                                {% set wstatus = \"EXPIRES TODAY\" %}\r\n                            {% else %}\r\n                                {% set wstatus = 'UNKNOWN' %}\r\n                            {% endif %}\r\n                        {% else %}\r\n                            {% set wstatus = \"N/A\" %}\r\n                        {% endif %}\r\n                        <tr class=\"nospace-row\">\r\n                            <td class=\"label-cell\">\r\n                                Item Group:\r\n                            </td>   \r\n                            <td class=\"data-cell\">\r\n                                {{ thisproduct.item_group }}\r\n                            </td>\r\n                            <td class=\"label-cell\">\r\n                                {% if doc.serial_number and wstatus %}Warranty Status:{% endif %}\r\n                            </td>\r\n                            <td class=\"data-cell\">\r\n                                {% if doc.serial_number and wstatus %}\r\n                                    {% if wstatus == \"INVALID\" %}\r\n                                        <span style=\"color: red;\">\r\n                                    {% elif wstatus == \"VALID\" %}\r\n                                        <span style=\"color: green;\">\r\n                                    {% elif wstatus == \"EXPIRES TODAY\" %}\r\n                                        <span style=\"color: orange;\">\r\n                                    {% else %}\r\n                                        <span>\r\n                                    {% endif %}\r\n                                    {{ wstatus }}        \r\n                                    </span>\r\n                                {% endif %}\r\n                            </td>\r\n                        </tr>\r\n                    </tbody></table>\r\n                </div>\r\n                {% if thisproduct.image %}\r\n                    <div id=\"product-image\">\r\n                        {% set display_image = '<img src=\\\"' ~ thisproduct.image ~ '\\\" style=\\\"max-width: 2cm; max-height: 2cm;\\\">' | safe %}\r\n                        {{ display_image }}\r\n                    </div>\r\n                {% endif %}            \r\n            </div>\r\n        {% endif %}\r\n    {% endif %}\r\n    \r\n    <table class=\"layout-table\"><tbody><tr class=\"layout-row\">\r\n        <td class=\"layout-cell\" id=\"fault-report-cell\">\r\n            <div id=\"fault-report\" class=\"black-box\">\r\n                <div class=\"yellow-bar\">Fault Report</div>\r\n                <div class=\"box-content-left\">\r\n                    {% if doc.description %}{{ doc.description }}{% endif %}\r\n                </div>\r\n            </div>\r\n        </td>\r\n        <td class=\"layout-cell\" id=\"office-use-cell\">\r\n            <div>\r\n                <div id=\"office-use\" class=\"black-box\">\r\n                    <div class=\"yellow-bar\">Billing Information</div>\r\n                    <table class=\"layout-table\"><tbody><tr class=\"layout-row\">\r\n                        <td class=\"layout-cell\" id=\"one-third\">\r\n                            <div>\r\n                                <table class=\"layout-table\"><tbody>\r\n                                    <tr class=\"layout-row\"><td class=\"layout-cell box-content-center\">\r\n                                        {% set quotations = frappe.get_all(\"Quotation\", filters={\"service_order\": doc.name, \"docstatus\": 1}, order_by=\"transaction_date desc, modified desc\") %}\r\n                                        {% if quotations|length %}\r\n                                            {{ quotations[0]['name'] }}\r\n                                        {% else %}\r\n                                            <br>\r\n                                        {% endif %}\r\n                                    </td></tr>\r\n                                    <tr class=\"layout-row\"><td class=\"layout-cell fill-in-field\">\r\n                                        Quotation\r\n                                    </td></tr>\r\n                                </tbody></table>\r\n                            </div>\r\n                        </td>   \r\n                        <td class=\"layout-cell\" id=\"one-third\">\r\n                            <div>\r\n                                <table class=\"layout-table\"><tbody>\r\n                                    <tr class=\"layout-row\"><td class=\"layout-cell box-content-center\">\r\n                                        {% set deliveries = frappe.get_all(\"Delivery Note\", filters={\"service_order\": doc.name, \"docstatus\": 1}, order_by=\"posting_date desc, posting_time desc\") %}\r\n                                        {% if deliveries|length %}\r\n                                            {{ deliveries[0]['name'] }}\r\n                                        {% else %}\r\n                                            <br>\r\n                                        {% endif %}\r\n                                    </td></tr>\r\n                                    <tr class=\"layout-row\"><td class=\"layout-cell fill-in-field\">\r\n                                        Delivery Note\r\n                                    </td></tr>\r\n                                </tbody></table>\r\n                            </div>\r\n                        </td>   \r\n                        <td class=\"layout-cell\" id=\"one-third\">\r\n                            <div>\r\n                                <table class=\"layout-table\"><tbody>\r\n                                    <tr class=\"layout-row\"><td class=\"layout-cell box-content-center\">\r\n                                        {% set invoices = frappe.get_all(\"Sales Invoice\", filters={\"service_order\": doc.name, \"docstatus\": 1}, order_by=\"posting_date desc, posting_time desc\") %}\r\n                                        {% if invoices|length %}\r\n                                            {{ invoices[0]['name'] }}\r\n                                        {% else %}\r\n                                            <br>\r\n                                        {% endif %}\r\n                                    </td></tr>\r\n                                    <tr class=\"layout-row\"><td class=\"layout-cell fill-in-field\">\r\n                                        Invoice\r\n                                    </td></tr>\r\n                                </tbody></table>\r\n                            </div>\r\n                        </td>   \r\n                    </tr></tbody></table>\r\n                </div>\r\n            </div>\r\n            <div>\r\n                <div id=\"tech-cert\" class=\"black-box\">\r\n                    <div class=\"yellow-bar\">Certified Tested & Working By Technician</div>\r\n                    <table class=\"layout-table\"><tbody><tr class=\"layout-row\">\r\n                        <td class=\"layout-cell\" id=\"one-half\">\r\n                            <div class=\"fill-in-field\">\r\n                                Date Tested\r\n                            </div>\r\n                        </td>\r\n                        <td class=\"layout-cell\" id=\"one-half\">\r\n                            <div class=\"fill-in-field\">\r\n                                Technician Signature\r\n                            </div>\r\n                        </td>                    \r\n                    </tr></tbody></table>\r\n                </div>                \r\n            </div>\r\n        </td>        \r\n    </tr></tbody></table>\r\n</div>\r\n<div id=\"middle-section\">\r\n    <div class=\"black-box\">\r\n        <div class=\"yellow-bar\">Terms & Conditions</div>\r\n        <div class=\"box-content-justified\">\r\n            {% set issueterms = frappe.get_doc(\"Terms and Conditions\", \"Issue Terms\") %}\r\n            {% if issueterms and issueterms.terms != 'None' %}\r\n                {{ issueterms.terms }}\r\n            {% endif %}\r\n        </div>\r\n    </div>\r\n    <div class=\"black-box\">\r\n        <div class=\"yellow-bar\">Booking In</div>\r\n        <table class=\"layout-table\"><tbody><tr class=\"layout-row\">\r\n            <td class=\"layout-cell\" id=\"one-quarter\">\r\n                <div class=\"fill-in-field\">\r\n                    Date\r\n                </div>\r\n            </td>\r\n            <td class=\"layout-cell\" id=\"one-quarter\">\r\n                <div class=\"fill-in-field\">\r\n                    Full Name\r\n                </div>\r\n            </td>\r\n            <td class=\"layout-cell\" id=\"one-quarter\">\r\n                <div class=\"fill-in-field\">\r\n                    I.D. Number\r\n                </div>\r\n            </td>\r\n            <td class=\"layout-cell\" id=\"one-quarter\">\r\n                <div class=\"fill-in-field\">\r\n                    Signature\r\n                </div>\r\n            </td>            \r\n        </tr></tbody></table>\r\n        <div class=\"box-content-center\" style=\"font-weight: bold; font-size: 6pt;\">\r\n            By signing this section, as a duly authorised signatory and representative of the customer, \r\n            you certify that you have read, understood and hereby agree to the terms and conditions above.\r\n        </div>        \r\n    </div>\r\n    \r\n    <div class=\"black-box\">\r\n        <div class=\"yellow-bar\">Collection</div>\r\n        <table class=\"layout-table\"><tbody><tr class=\"layout-row\">\r\n            <td class=\"layout-cell\" id=\"one-quarter\">\r\n                <div class=\"fill-in-field\">\r\n                    Date\r\n                </div>\r\n            </td>\r\n            <td class=\"layout-cell\" id=\"one-quarter\">\r\n                <div class=\"fill-in-field\">\r\n                    Full Name\r\n                </div>\r\n            </td>\r\n            <td class=\"layout-cell\" id=\"one-quarter\">\r\n                <div class=\"fill-in-field\">\r\n                    I.D. Number\r\n                </div>\r\n            </td>\r\n            <td class=\"layout-cell\" id=\"one-quarter\">\r\n                <div class=\"fill-in-field\">\r\n                    Signature\r\n                </div>\r\n            </td>            \r\n        </tr></tbody></table>\r\n        <div class=\"box-content-center\" style=\"font-weight: bold; font-size: 6pt;\">\r\n            By signing this section, as a duly authorised signatory and representative of the customer, \r\n            you certify that the product has been tested and is working correctly at time of collection.\r\n        </div>        \r\n    </div>    \r\n    \r\n</div>\r\n<div id=\"middle-section\">\r\n                {% set banks = frappe.get_all('Bank Account', filters={'display_on_invoice': '1'}, fields=['bank_account_no', 'branch_code', 'display_name', 'account_name', 'account_type' ], order_by='account_type') %}\r\n                {% set banks_displayed = 0 %}\r\n                <div class=\"yellow-box\" id=\"bank-info\">\r\n                    <div class=\"yellow-bar\">Banking Details</div>\r\n                    <div class=\"bank-account\" >\r\n                        <strong>Bank:</strong>\r\n                        <br>\r\n                        <strong>Branch:</strong>\r\n                        <br>\r\n                        <strong>Account:</strong>\r\n                    </div>\r\n                    {% for bank in banks %}\r\n                        {% if banks_displayed < 6 and bank.bank_account_no %}\r\n                            <div class=\"bank-account\" >\r\n                                {% if bank.display_name %}\r\n                                    {{ bank.display_name }}\r\n                                {% else %}\r\n                                    {{ bank.account_name }}\r\n                                {% endif %}\r\n                                <br>\r\n                                {{ bank.branch_code }}\r\n                                <br>\r\n                                {{ bank.bank_account_no }}\r\n                            </div>\r\n                            {% set banks_displayed = banks_displayed + 1 %}\r\n                        {% endif %}\r\n                    {% endfor %}\r\n                </div>    \r\n</div>\r\n\r\n<div id=\"middle-section\">\r\n    {% if doc.multiple_devices %}\r\n        <div class=\"black-box\">\r\n            <table id=\"device_list\" class=\"layout-table\">\r\n                <tbody>\r\n                    <tr class=\"layout-row\">\r\n                        <td class=\"layout-cell\" id=\"item-model\">\r\n                            <div class=\"yellow-bar\">Model</div>\r\n                        </td>\r\n                        <td class=\"layout-cell\" id=\"item-serial-number\">\r\n                            <div class=\"yellow-bar\">Serial Number</div>\r\n                        </td>\r\n                    </tr>\r\n                    {% for device in doc.devices %}\r\n                        <tr class=\"layout-row\">\r\n                            <td class=\"layout-cell box-content-left\" style=\"padding-left: 16px !important;\">\r\n                                <div><strong>{{ device.model }}</strong>: {{ device.model_name }}</div>\r\n                            </td>\r\n                            <td class=\"layout-cell box-content-center\">\r\n                                <div>{{ device.serial_number }}</div>\r\n                            </td>\r\n                        </tr>\r\n                    {% endfor %}\r\n                </tbody>\r\n            </table>\r\n        </div>\r\n    {% endif %}\r\n\r\n    {% if doc.resolution_details %}\r\n        <div class=\"black-box\">\r\n            <div class=\"yellow-bar\">Resolution Details</div>\r\n            <div class=\"box-content-left\" style=\"padding-left: 10px !important;\">\r\n                {{ doc.resolution_details }}\r\n            </div>\r\n        </div>\r\n    {% endif %}\r\n</div>",
 "idx": 0,
 "line_breaks": 0,
 "modified": "2021-10-12 11:01:32.289097",
 "modified_by": "andrew@eskilltrading.com",
 "module": "Eskill Customisations",
 "name": "Service Order",
 "owner": "andrew@eskilltrading.com",
 "print_format_builder": 0,
 "print_format_type": "Jinja",
 "raw_printing": 0,
 "show_section_headings": 0,
 "standard": "Yes"
}